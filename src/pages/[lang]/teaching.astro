---
import { getEntry } from "astro:content";
import BaseLayout from "../../layouts/BaseLayout.astro";
import MainLayout from "../../components/layout/MainLayout.astro";
import ContentSection from "../../components/sections/ContentSection.astro";
import { useTranslations, type Language } from "../../i18n";

export async function getStaticPaths() {
  return [{ params: { lang: "en" } }, { params: { lang: "zh" } }];
}

const { lang } = Astro.params as { lang: Language };
const t = useTranslations(lang);

// Get profile data
const profile = await getEntry("profile", lang);

// Get lectures content
const lecturesEntry = await getEntry("lectures", lang);
const lecturesItems = lecturesEntry ? [{
  title: lecturesEntry.data.title,
  content: lecturesEntry.body || ""
}] : [];

// Get supervision content
const supervisionEntry = await getEntry("supervision", lang);
const supervisionItems = supervisionEntry ? [{
  title: supervisionEntry.data.title,
  content: supervisionEntry.body || ""
}] : [];
---

<BaseLayout
  title={`${profile?.data.name} - ${t("nav.teaching")}`}
  description={`${t("nav.teaching")} - ${profile?.data.name}`}
  lang={lang}
>
  <MainLayout
    name={profile?.data.name || "Cheng LYU"}
    lang={lang}
    currentPath="/teaching"
    photo={profile?.data.photo || "/images/photo.jpg"}
    contacts={profile?.data.contacts || []}
  >
    <ContentSection title={t("sections.lectures")} items={lecturesItems} />
    <ContentSection title={t("sections.supervision")} items={supervisionItems} />
  </MainLayout>
</BaseLayout>
